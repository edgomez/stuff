#!/bin/sh

opt_mount=1

g_progname="$(basename "$0")"

print_help()
{
    cat << __EOF__
usage: $g_progname [OPTIONS]

OPTIONS

-u, --umount     Umount the freebox

-h, --help       Print this help message
__EOF__
}

parse_args()
{
    while [ $# -ne 0 ] ; do
    case "$1" in
    -u|--umount) opt_mount=0; ;;
    -h|--help) print_help; exit 0; ;;
    esac
    shift
    done
}

mount_freebox()
{
    mkdir -p "$HOME/mnt/freebox"
    sudo mount.cifs \
        -o vers=1.0,guest,uid=$(id -un),iocharset=utf8 \
        "//mafreebox.freebox.fr/Disque Dur" \
        "$HOME/mnt/freebox/"
}

umount_freebox()
{
    sudo umount -f "$HOME/mnt/freebox/"
}

main()
{
    parse_args "$@"
    if [ $opt_mount -ne 0 ] ; then
        mount_freebox
    else
        umount_freebox
    fi
}

main "$@"
